(function(){this.LOLCoffee={KEYWORDS:"IF U SAY SO,IM OUTTA YR,QUOSHUNT OF,PRODUKT OF,BOTH SAEM,EITHER OF,HOW DUZ I,SMALLR OF,BIGGR OF,CHARZ OF,DIFFRINT,FOUND YR,IM IN YR,IS NOW A,LENGZ OF,BOTH OF,DIFF OF,I HAS A,KTHXBYE,ORDZ OF,VISIBLE,ALL OF,ANY OF,BUKKIT,GIMMEH,MOD OF,NERFIN,NUMBAR,NO WAI,O RLY?,OMGWTF,SMOOSH,SUM OF,WON OF,YA RLY,MEBBE,NUMBR,TROOF,UPPIN,FAIL,GTFO,INTA,MAEK,MKAY,NOOB,PUTZ,WILE,WTF?,YARN,HAI,ITZ,NOT,OIC,OMG,TIL,WIN,AN,AT,YR,!,A,R".split(","),UNARY_OPERATORS:["NOT","LENGZ OF","CHARZ OF",
"ORDZ OF"],BINARY_OPERATORS:"SUM OF,DIFF OF,PRODUKT OF,QUOSHUNT OF,MOD OF,BIGGR OF,SMALLR OF,BOTH OF,EITHER OF,WON OF,BOTH SAEM,DIFFRINT".split(","),INFINITARY_OPERATORS:["ALL OF","ANY OF","SMOOSH"],DEFAULT_VALUES:{YARN:"",NUMBR:0,NUMBAR:0,TROOF:false,NOOB:null}}}).call(this);
(function(){var d,w,j,x,u,o,s,t,r,i,a,c,g,y,m,G,p,v,f,z,B,H,C,l,I,J,K,q,L,M,N,O,P,k,E,b,h,n,Q,R={}.hasOwnProperty,A=function(a,e){function b(){this.constructor=a}for(var h in e)R.call(e,h)&&(a[h]=e[h]);b.prototype=e.prototype;a.prototype=new b;a.__super__=e.prototype;return a};a=this.LOLCoffee.DEFAULT_VALUES;l=function(a){function e(e){this.message=e+"."}A(e,a);e.name="MachineError";e.prototype.name="MachineError";return e}(Error);n=function(){function b(e,a){this.type=e;this.value=a}b.name="Value";
b.prototype.equal=function(e){var a,b;return((a=this.type)==="float"||a==="int")&&((b=e.type)==="float"||b==="int")?this.value===e.value:this.type===e.type?this.value===e.value:false};b.prototype.cast=function(e,h){var F;h==null&&(h=false);if(e==="null")throw new l("Cannot cast to NOOB");F=null;switch(this.type){case "null":if(h){if(!(e in a))throw new l("Unknown type: "+e);F=a[e]}else{if(e!=="bool")throw new l("Cannot implicitly cast NOOB to "+e);F=false}break;case "bool":F=function(){switch(e){case "bool":return this.value;
case "int":case "float":return Number(this.value);case "string":return this.value?"WIN":"FAIL";default:throw new l("Unknown type: "+e);}}.call(this);break;case "int":F=function(){switch(e){case "bool":return this.value!==0;case "int":case "float":return this.value;case "string":return String(this.value);default:throw new l("Unknown type: "+e);}}.call(this);break;case "float":F=function(){switch(e){case "bool":return this.value!==0;case "int":return Math.floor(this.value);case "float":return this.value;
case "string":return String(this.value);default:throw new l("Unknown type: "+e);}}.call(this);break;case "string":F=function(){switch(e){case "bool":return this.value!=="";case "int":if(!/^-?\d+$/.test(this.value))throw new l("Cannot parse NUMBR from '"+this.value+"'");return parseInt(this.value,10);case "float":if(!/^-?(\d+(\.\d*)?|\.\d+)$/.test(this.value))throw new l("Cannot parse NUMBAR from '"+this.value+"'");return parseFloat(this.value);case "string":return this.value;default:throw new l("Unknown type: "+
e);}}.call(this);break;default:throw new l("Unknown type: "+this.type);}return new b(e,F)};return b}();m=function(){function a(e,b){this.name=e;this.instruction_ptr=b;this.variables={};this.stack=[]}a.name="Frame";return a}();f=function(){function a(){}a.name="Halt";a.prototype.exec=function(e){e.halted=true;return e.done()};return a}();H=function(){function a(e){this.label=e}a.name="Jump";a.prototype.exec=function(e){return e.instruction_ptr=e.labels[this.label]};return a}();C=function(){function a(e){this.label=
e}a.name="JumpIfZero";a.prototype.exec=function(e){if(e.getStack().pop().value===false)return e.instruction_ptr=e.labels[this.label]};return a}();c=function(){function a(e,b){this.name=e;this.label=b}a.name="DeclareFunction";a.prototype.exec=function(e){return e.functions[this.name]=e.labels[this.label]};return a}();g=function(){function a(e){this.identifier=e}a.name="DeclareVariable";a.prototype.exec=function(e){if(this.identifier==="IT")throw new l("Cannot declare the special variable IT");return e.frames.slice(-1)[0].variables[this.identifier]=
new n("null",null)};return a}();u=function(){function a(e){this.identifier=e}a.name="Assign";a.prototype.exec=function(e){var a,b,h;a=e.frames[0].variables;b=e.frames.slice(-1)[0].variables;h=e.getStack().pop();if(this.identifier in b)return b[this.identifier]=h;else if(this.identifier in a)return a[this.identifier]=h;else if(e.auto_declare)return b[this.identifier]=h;else throw new l("Assignment to undefined variable: "+this.identifier);};return a}();o=function(){function a(e){this.identifier=e}
a.name="AssignAtIndex";a.prototype.exec=function(e){var a,b,h;b=e.frames[0].variables;a=e.frames.slice(-1)[0].variables;if(this.identifier in a)b=a;else if(!(this.identifier in b))if(e.auto_declare)b=a;else throw new l("Assignment to undefined variable: "+this.identifier);a=b[this.identifier];h=e.getStack().pop();e=e.getStack().pop();if(a.type!=="string")throw new l("Can only index YARNs, not "+a.type);if(h.type!=="int")throw new l("Can only index using NUMBRs, not "+h.type);if(h.value>=a.value.length)throw new l("Out of bounds: '"+
a.value+"'["+h.value+"]");if(e.type!=="string"||e.value.length!==1)throw new l("Can only assign single-character YARNs to YARN indices, not "+e.value);a=a.value;e=a.slice(0,h.value)+e.value+a.slice(h.value+1);return b[this.identifier]=new n("string",e)};return a}();z=function(){function a(){}a.name="Input";a.prototype.exec=function(e){e.pause();return e.input()};return a}();M=function(){function a(){}a.name="Output";a.prototype.exec=function(e){e.pause();return e.output(e.getStack().pop().value)};
return a}();O=function(){function a(){}a.name="PushSyscallResult";a.prototype.exec=function(e){var a;a=(a=e.syscall_result)?String(a):"";return e.getStack().push(new n("string",a))};return a}();P=function(){function a(e){this.identifier=e}a.name="PushVariable";a.prototype.exec=function(e){var a,b;a=e.frames[0].variables;b=e.frames.slice(-1)[0].variables;if(this.identifier in b)a=b[this.identifier];else if(this.identifier in a)a=a[this.identifier];else throw new l("Reference to undefined variable: "+
this.identifier);return e.getStack().push(a)};return a}();p=function(){function a(){}a.name="GetIndex";a.prototype.exec=function(a){var b,h;b=a.getStack().pop();h=a.getStack().pop();if(b.type!=="string")throw new l("Can only index YARNs, not "+b.type);if(h.type!=="int")throw new l("Can only index using NUMBRs, not "+h.type);if(h.value>=b.value.length)throw new l("Out of bounds: '"+b.value+"'["+h.value+"]");return a.getStack().push(new n("string",b.value[h.value]))};return a}();N=function(){function a(e,
b){this.type=e;this.value=b}a.name="PushLiteral";a.prototype.exec=function(a){return a.getStack().push(new n(this.type,this.value))};return a}();r=function(){function a(e,b){this.type=e;this.explicit=b!=null?b:false}a.name="Cast";a.prototype.exec=function(a){return a.getStack().push(a.getStack().pop().cast(this.type,this.explicit))};return a}();t=function(){function a(e,b){this.func_name=e;this.args_count=b}a.name="Call";a.prototype.exec=function(a){var b,h,f;b=a.getStack();a.frames.push(new m(this.func_name,
a.instruction_ptr));for(h=0,f=this.args_count;0<=f?h<f:h>f;0<=f?++h:--h)a.getStack().push(b.pop());return a.instruction_ptr=a.functions[this.func_name]};return a}();k=function(){function a(){}a.name="Return";a.prototype.exec=function(a){var b,h;h=a.getStack().pop();b=a.frames.pop();a.instruction_ptr=b.instruction_ptr;return a.getStack().push(h)};return a}();w=function(){function a(e){this.args_count=e}a.name="All";a.prototype.exec=function(a){var b,h,f,c,D;D=[];for(b=0,h=this.args_count;0<=h?b<h:
b>h;0<=h?++b:--b)D.push(a.getStack().pop().cast("bool").value);h=true;for(f=0,c=D.length;f<c;f++)if(b=D[f],!b){h=false;break}return a.getStack().push(new n("bool",h))};return a}();x=function(){function a(e){this.args_count=e}a.name="Any";a.prototype.exec=function(a){var b,h,f,c,D;D=[];for(b=0,h=this.args_count;0<=h?b<h:b>h;0<=h?++b:--b)D.push(a.getStack().pop().cast("bool").value);h=false;for(f=0,c=D.length;f<c;f++)if(b=D[f]){h=true;break}return a.getStack().push(new n("bool",h))};return a}();i=function(){function a(e){this.args_count=
e}a.name="Concat";a.prototype.exec=function(a){var b,h,f;f=[];for(b=0,h=this.args_count;0<=h?b<h:b>h;0<=h?++b:--b)f.push(a.getStack().pop().cast("string").value);return a.getStack().push(new n("string",f.join("")))};return a}();j=function(){function a(){}a.name="MathOperation";a.prototype.exec=function(a,b){var h,f,c;h=a.getStack().pop();f=a.getStack().pop();c="float"===h.type||"float"===f.type?"float":"int";h=h.cast(c).value;f=f.cast(c).value;h=b(h,f);c==="int"&&(h=Math.floor(h));return a.getStack().push(new n(c,
h))};return a}();d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}A(b,a);b.name="Add";b.prototype.exec=function(a){return b.__super__.exec.call(this,a,function(a,b){return a+b})};return b}(j);E=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}A(b,a);b.name="Subtract";b.prototype.exec=function(a){return b.__super__.exec.call(this,a,function(a,b){return a-b})};return b}(j);q=function(a){function b(){return b.__super__.constructor.apply(this,
arguments)}A(b,a);b.name="Multiply";b.prototype.exec=function(a){return b.__super__.exec.call(this,a,function(a,b){return a*b})};return b}(j);y=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}A(b,a);b.name="Divide";b.prototype.exec=function(a){return b.__super__.exec.call(this,a,function(a,b){return a/b})};return b}(j);K=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}A(b,a);b.name="Modulo";b.prototype.exec=function(a){return b.__super__.exec.call(this,
a,function(a,b){return a%b})};return b}(j);I=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}A(b,a);b.name="Max";b.prototype.exec=function(a){return b.__super__.exec.call(this,a,function(a,b){return a>b?a:b})};return b}(j);J=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}A(b,a);b.name="Min";b.prototype.exec=function(a){return b.__super__.exec.call(this,a,function(a,b){return a<b?a:b})};return b}(j);s=function(){function a(){}a.name="BoolOperation";
a.prototype.exec=function(a,b){var h,f;h=a.getStack().pop().cast("bool").value;f=a.getStack().pop().cast("bool").value;return a.getStack().push(new n("bool",b(h,f)))};return a}();j=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}A(b,a);b.name="And";b.prototype.exec=function(a){return b.__super__.exec.call(this,a,function(a,b){return a&&b})};return b}(s);L=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}A(b,a);b.name="Or";b.prototype.exec=
function(a){return b.__super__.exec.call(this,a,function(a,b){return a||b})};return b}(s);Q=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}A(b,a);b.name="Xor";b.prototype.exec=function(a){return b.__super__.exec.call(this,a,function(a,b){return a^b})};return b}(s);s=function(){function a(){}a.name="Equal";a.prototype.exec=function(a){var b,h;b=a.getStack().pop();h=a.getStack().pop();return a.getStack().push(new n("bool",b.equal(h)))};return a}();h=function(){function a(){}
a.name="Unequal";a.prototype.exec=function(a){var b,h;b=a.getStack().pop();h=a.getStack().pop();return a.getStack().push(new n("bool",!b.equal(h)))};return a}();B=function(){function a(){}a.name="Invert";a.prototype.exec=function(a){var b;b=a.getStack().pop().cast("bool").value;return a.getStack().push(new n("bool",!b))};return a}();v=function(){function a(){}a.name="GetLength";a.prototype.exec=function(a){var b;b=a.getStack().pop();if(b.type!=="string")throw new l("Can only get length of YARNs");
return a.getStack().push(new n("int",b.value.length))};return a}();G=function(){function a(){}a.name="FromCharCode";a.prototype.exec=function(a){var b;b=a.getStack().pop();if(b.type!=="int")throw new l("Character codes must be NUMBRs, not "+b.type);b=String.fromCharCode(b.value);return a.getStack().push(new n("string",b))};return a}();b=function(){function a(){}a.name="ToCharCode";a.prototype.exec=function(a){var b;b=a.getStack().pop();if(b.type!=="string"||!b.value.length)throw new l("Can only take character code of non-empty "+
("YARNs, not '"+b.type+"'"));return a.getStack().push(new n("int",b.value.charCodeAt(0)))};return a}();this.LOLCoffee.Machine=function(){function a(b,h,f,c,n,E){var d=this;this.context=b;this.input=h;this.output=f;this.error=c;this.done=n;this.auto_declare=E;this.instructions=this.context.instructions;this.labels=this.context.labels;this.reset();this.input=this.input||function(){return d.resume()};this.output=this.output||function(){return d.resume()};this.error=this.error||function(){};this.done=
this.done||function(){};this.auto_declare=this.auto_declare||false}a.name="Machine";a.prototype.reset=function(){this.instruction_ptr=0;this.frames=[new m("{MAIN}",0)];this.frames[0].variables.IT=new n("null",null);this.functions={};this.halted=true;this.blocked=false;return this.syscall_result=null};a.prototype.step=function(){if(this.blocked||this.halted||this.instruction_ptr>=this.instructions.length)throw new l("Cannot execute while blocked, halted or at end");try{return this.instructions[this.instruction_ptr++].exec(this)}catch(a){return this.error(a),
this.halted=true}};a.prototype.run=function(){var a;this.halted=false;for(a=[];!this.blocked&&!this.halted;)a.push(this.step());return a};a.prototype.pause=function(){return this.blocked=true};a.prototype.resume=function(a){a==null&&(a=null);this.syscall_result=a;this.blocked=false;if(!this.halted)return this.run()};a.prototype.getStack=function(){return this.frames[this.frames.length-1].stack};return a}();this.LOLCoffee.MachineError=l;this.LOLCoffee.Instructions={Halt:f,PushLiteral:N,DeclareFunction:c,
Jump:H,DeclareVariable:g,Assign:u,AssignAtIndex:o,Return:k,Input:z,PushSyscallResult:O,Output:M,PushVariable:P,GetIndex:p,Cast:r,JumpIfZero:C,Call:t,All:w,Any:x,Concat:i,Add:d,Subtract:E,Multiply:q,Divide:y,Modulo:K,Max:I,Min:J,And:j,Or:L,Xor:Q,Equal:s,Unequal:h,Invert:B,GetLength:v,FromCharCode:G,ToCharCode:b}}).call(this);
(function(){var d,w,j,x,u,o,s,t,r,i,a,c,g,y,m,G,p,v,f,z,B,H,C,l,I,J,K,q,L,M,N,O,P={}.hasOwnProperty,k=function(a,b){function h(){this.constructor=a}for(var f in b)P.call(b,f)&&(a[f]=b[f]);h.prototype=b.prototype;a.prototype=new h;a.__super__=b.prototype;return a};f=this.LOLCoffee.Instructions;t=function(a){function b(a){this.message=a}k(b,a);b.name="CodeGenError";b.prototype.name="CodeGenError";return b}(Error);s=function(){function a(){this.instructions=[];this.labels=[];this._break_stack=[]}a.name=
"CodeGenContext";a.prototype.emit=function(a){return this.instructions.push(a)};a.prototype.newLabel=function(){this.labels.push(null);return this.labels.length-1};a.prototype.emitLabel=function(a){if(a>=this.labels.length)throw new t("Unknown label ("+a+"). Top: "+this.labels.length);return this.labels[a]=this.instructions.length};a.prototype.getBreakLabel=function(){return this._break_stack[this._break_stack.length-1]};a.prototype.popBreakLabel=function(){return this._break_stack.pop()};a.prototype.pushBreakLabel=
function(a){return this._break_stack.push(a)};return a}();C=function(){function a(){}a.name="Node";return a}();J=function(a){function b(a){this.body=a}k(b,a);b.name="Program";b.prototype.codegen=function(a){this.body.codegen(a);return a.emit(new f.Halt)};return b}(C);g=function(a){function b(a,b,f){this.name=a;this.args=b;this.body=f}k(b,a);b.name="FunctionDefinition";b.prototype.codegen=function(a){var b,c,d,g,E;b=a.newLabel();c=a.newLabel();a.emit(new f.DeclareFunction(this.name,b));a.emit(new f.Jump(c));
a.emitLabel(b);this.args.reverse();E=this.args;for(d=0,g=E.length;d<g;d++)b=E[d],a.emit(new f.DeclareVariable(b)),a.emit(new f.Assign(b));this.body.codegen(a);return a.emitLabel(c)};return b}(C);q=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}k(b,a);b.name="Statement";return b}(C);K=function(a){function b(a){this.value=a}k(b,a);b.name="Return";b.prototype.codegen=function(a){this.value.codegen(a);return a.emit(new f.Return)};return b}(q);v=function(a){function b(a){this.identifier=
a}k(b,a);b.name="Input";b.prototype.codegen=function(a){a.emit(new f.Input);a.emit(new f.PushSyscallResult);return a.emit(new f.Assign(this.identifier))};return b}(q);I=function(a){function b(a){this.expression=a}k(b,a);b.name="Output";b.prototype.codegen=function(a){this.expression.codegen(a);return a.emit(new f.Output)};return b}(q);i=function(a){function b(a){this.identifier=a}k(b,a);b.name="Declaration";b.prototype.codegen=function(a){return a.emit(new f.DeclareVariable(this.identifier))};return b}(q);
d=function(a){function b(a,b){this.identifier=a;this.value=b}k(b,a);b.name="Assignment";b.prototype.codegen=function(a){this.value.codegen(a);return a.emit(new f.Assign(this.identifier))};return b}(q);m=function(a){function b(a,b,f){this.identifier=a;this.index=b;this.value=f}k(b,a);b.name="IndexedAssignment";b.prototype.codegen=function(a){this.value.codegen(a);this.index.codegen(a);return a.emit(new f.AssignAtIndex(this.identifier))};return b}(q);x=function(a){function b(){}k(b,a);b.name="Break";
b.prototype.codegen=function(a){return a.emit(new f.Jump(a.getBreakLabel()))};return b}(q);L=function(a){function b(a){this.statements=a}k(b,a);b.name="StatementList";b.prototype.codegen=function(a){var b,f,c,d,g;d=this.statements;g=[];for(f=0,c=d.length;f<c;f++)b=d[f],g.push(b.codegen(a));return g};return b}(q);r=function(a){function b(a,b){this.then_body=a;this.else_body=b}k(b,a);b.name="Conditional";b.prototype.codegen=function(a){var b,c;b=a.newLabel();c=a.newLabel();a.emit(new f.PushVariable("IT"));
a.emit(new f.Cast("bool"));a.emit(new f.JumpIfZero(b));this.then_body.codegen(a);a.emit(new f.Jump(c));a.emitLabel(b);this.else_body&&this.else_body.codegen(a);return a.emitLabel(c)};return b}(q);N=function(a){function b(a,b){this.cases=a;this.default_case=b}k(b,a);b.name="Switch";b.prototype.codegen=function(a){var b,c,d,g,i,e,z,v,y;e=this.cases;for(i=0,d=e.length;i<d;i++)c=e[i],c.push(a.newLabel());this.default_case&&(g=a.newLabel());c=a.newLabel();v=this.cases;for(e=0,z=v.length;e<z;e++)b=v[e],
d=b[0],i=b[2],d.codegen(a),a.emit(new f.PushVariable("IT")),a.emit(new f.Unequal),a.emit(new f.JumpIfZero(i));this.default_case&&a.emit(new f.Jump(g));a.pushBreakLabel(c);z=this.cases;for(d=0,e=z.length;d<e;d++)y=z[d],b=y[1],i=y[2],a.emitLabel(i),b.codegen(a);this.default_case&&(a.emitLabel(g),this.default_case.codegen(a));a.popBreakLabel();return a.emitLabel(c)};return b}(q);H=function(a){function b(a,b,f){this.step=a;this.condition=b;this.body=f}k(b,a);b.name="Loop";b.prototype.codegen=function(a){var b,
c;c=a.newLabel();b=a.newLabel();a.emitLabel(c);this.condition&&(this.condition.codegen(a),a.emit(new f.Cast("bool")),a.emit(new f.JumpIfZero(b)));this.body.codegen(a);this.step&&this.step.codegen(a);a.emit(new f.Jump(c));return a.emitLabel(b)};return b}(q);a=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}k(b,a);b.name="Expression";return b}(C);u=function(a){function b(a,b){this.func_name=a;this.args=b}k(b,a);b.name="CallExpression";b.prototype.codegen=function(a){var b,
c,d,g;g=this.args;for(c=0,d=g.length;c<d;c++)b=g[c],b.codegen(a);return a.emit(new f.Call(this.func_name,this.args.length))};return b}(a);y=function(a){function b(a){this.identifier=a}k(b,a);b.name="IdentifierExpression";b.prototype.codegen=function(a){return a.emit(new f.PushVariable(this.identifier))};return b}(a);G=function(a){function b(a,b){this.base=a;this.index=b}k(b,a);b.name="IndexingExpression";b.prototype.codegen=function(a){this.index.codegen(a);this.base.codegen(a);return a.emit(new f.GetIndex)};
return b}(a);o=function(a){function b(a,b){this.expression=a;this.type=b}k(b,a);b.name="CastExpression";b.prototype.codegen=function(a){var b;this.expression.codegen(a);b=function(){switch(this.type){case "NOOB":return"null";case "TROOF":return"bool";case "NUMBR":return"int";case "NUMBAR":return"float";case "YARN":return"string"}}.call(this);return a.emit(new f.Cast(b,true))};return b}(a);p=function(a){function b(a,b){this.operator=a;this.operands=b}k(b,a);b.name="InfinitaryExpression";b.prototype.codegen=
function(a){var b,c,d,g;this.operands.reverse();g=this.operands;for(c=0,d=g.length;c<d;c++)b=g[c],b.codegen(a);b=function(){switch(this.operator){case "ALL OF":return new f.All(this.operands.length);case "ANY OF":return new f.Any(this.operands.length);case "SMOOSH":return new f.Concat(this.operands.length);default:throw new t("Unknown infinitary operator.");}}.call(this);return a.emit(b)};return b}(a);w=function(a){function b(a,b,f){this.operator=a;this.left=b;this.right=f}k(b,a);b.name="BinaryExpression";
b.prototype.codegen=function(a){var b;this.right.codegen(a);this.left.codegen(a);b=function(){switch(this.operator){case "SUM OF":return new f.Add;case "DIFF OF":return new f.Subtract;case "PRODUKT OF":return new f.Multiply;case "QUOSHUNT OF":return new f.Divide;case "MOD OF":return new f.Modulo;case "BIGGR OF":return new f.Max;case "SMALLR OF":return new f.Min;case "BOTH OF":return new f.And;case "EITHER OF":return new f.Or;case "WON OF":return new f.Xor;case "BOTH SAEM":return new f.Equal;case "DIFFRINT":return new f.Unequal;
default:throw new t("Unknown binary operator.");}}.call(this);return a.emit(b)};return b}(a);O=function(a){function b(a,b){this.operator=a;this.operand=b}k(b,a);b.name="UnaryExpression";b.prototype.codegen=function(a){var b;this.operand.codegen(a);b=function(){switch(this.operator){case "NOT":return new f.Invert;case "LENGZ OF":return new f.GetLength;case "CHARZ OF":return new f.FromCharCode;case "ORDZ OF":return new f.ToCharCode;default:throw new t("Unknown unary operator.");}}.call(this);return a.emit(b)};
return b}(a);B=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}k(b,a);b.name="Literal";return b}(a);l=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}k(b,a);b.name="NullLiteral";b.prototype.codegen=function(a){return a.emit(new f.PushLiteral("null",null))};return b}(B);j=function(a){function b(a){this.value=a}k(b,a);b.name="BoolLiteral";b.prototype.codegen=function(a){return a.emit(new f.PushLiteral("bool",this.value))};return b}(B);z=function(a){function b(a){this.value=
a}k(b,a);b.name="IntLiteral";b.prototype.codegen=function(a){return a.emit(new f.PushLiteral("int",this.value))};return b}(B);c=function(a){function b(a){this.value=a}k(b,a);b.name="FloatLiteral";b.prototype.codegen=function(a){return a.emit(new f.PushLiteral("float",this.value))};return b}(B);M=function(a){function b(a){this.value=a}k(b,a);b.name="StringLiteral";b.prototype.codegen=function(a){return a.emit(new f.PushLiteral("string",this.value))};return b}(B);this.LOLCoffee.CodeGenError=t;this.LOLCoffee.CodeGenContext=
s;this.LOLCoffee.AST={Node:C,Program:J,Statement:q,FunctionDefinition:g,Declaration:i,Return:K,Input:v,Output:I,Assignment:d,IndexedAssignment:m,Break:x,Loop:H,Conditional:r,Switch:N,StatementList:L,Expression:a,IdentifierExpression:y,IndexingExpression:G,CastExpression:o,CallExpression:u,UnaryExpression:O,BinaryExpression:w,InfinitaryExpression:p,Literal:B,NullLiteral:l,BoolLiteral:j,IntLiteral:z,FloatLiteral:c,StringLiteral:M}}).call(this);
(function(){var d,w,j,x,u,o,s={}.hasOwnProperty,t=function(d,a){function c(){this.constructor=d}for(var g in a)s.call(a,g)&&(d[g]=a[g]);c.prototype=a.prototype;d.prototype=new c;d.__super__=a.prototype;return d},r=[].indexOf||function(d){for(var a=0,c=this.length;a<c;a++)if(a in this&&this[a]===d)return a;return-1};d=this.LOLCoffee.AST;j=this.LOLCoffee.DEFAULT_VALUES;o=this.LOLCoffee.UNARY_OPERATORS;w=this.LOLCoffee.BINARY_OPERATORS;x=this.LOLCoffee.INFINITARY_OPERATORS;u=function(d){function a(a,
d){this.message="Line "+a+": "+d+"."}t(a,d);a.name="ParserError";a.prototype.name="ParserError";return a}(Error);this.LOLCoffee.Parser=function(){function i(a,c){this.tokens=a;this.function_arities=c!=null?c:{};this._scope_depth=0;this._in_function=false}i.name="Parser";i.prototype.parseProgram=function(){var a;if(!this.tokens.length)return new d.Program(new d.StatementList([]));if(a=this._nextIs("keyword","HAI"))this._consume(),this._nextIs("endline")||this._consume("float","1.2"),this._consume();
var c;for(c=[];this.tokens.length&&!this._nextIs("keyword","KTHXBYE");)c.push(this.parseStatement());this._nextIs("keyword","KTHXBYE")&&(a||this._error("KTHXBYE is not allowed when HAI is not used"),this._consume("keyword","KTHXBYE"),this._consume("endline"));this.tokens.length!==0&&this._error("Unexpected input after program end");return new d.Program(new d.StatementList(c))};i.prototype.parseFunctionDefinition=function(){var a,c,g;this._consume("keyword","HOW DUZ I");g=this._consume("identifier");
a=this.parseFunctionArgs();this._consume("endline");this.function_arities[g]=a.length;this._in_function=true;for(c=[];!this._nextIs("keyword","IF U SAY SO");)c.push(this.parseStatement());c.push(new d.Return(new d.IdentifierExpression("IT")));c=new d.StatementList(c);this._in_function=false;this._consume("keyword","IF U SAY SO");return new d.FunctionDefinition(g,a,c)};i.prototype.parseFunctionArgs=function(){var a;for(a=[];this._nextIs("keyword","YR");)if(this._consume(),a.push(this._consume("identifier")),
this._nextIs("keyword","AN"))this._consume();else break;return a};i.prototype.parseStatement=function(){var a;this._nextIs("keyword","IM IN YR")?a=this.parseLoopStatement():this._nextIs("keyword","O RLY?")?a=this.parseConditionalStatement():this._nextIs("keyword","WTF?")?a=this.parseSwitchStatement():this._nextIs("keyword","I HAS A")?a=this.parseDeclaration():this._nextIs("keyword","GIMMEH")?a=this.parseInputStatement():this._nextIs("keyword","VISIBLE")?a=this.parseOutputStatement():this._nextIs("keyword",
"PUTZ")?a=this.parseIndexedAssignment():this._nextIs("keyword","HOW DUZ I")?(this._in_function&&this._error("Cannot define nested functions"),a=this.parseFunctionDefinition()):this._nextIs("keyword","GTFO")?(this._scope_depth>0?a=new d.Break:this._in_function?a=new d.Return(new d.NullLiteral):this._error("GTFO must be inside a loop, switch, or function"),this._consume()):this._nextIs("keyword","FOUND YR")?(this._consume(),this._in_function||this._error("FOUND YR must be inside a function"),a=new d.Return(this.parseExpression())):
a=this.tokens.length>=2&&this._nextIs("identifier")&&this.tokens[1].is("keyword","R")?this.parseAssignment():this.tokens.length>=2&&this._nextIs("identifier")&&this.tokens[1].is("keyword","IS NOW A")?this.parseCastStatement():new d.Assignment("IT",this.parseExpression());this._consume("endline");return a};i.prototype.parseInputStatement=function(){this._consume("keyword","GIMMEH");return new d.Input(this._consume("identifier"))};i.prototype.parseDeclaration=function(){var a,c,g;this._consume("keyword",
"I HAS A");g=this._consume("identifier");c=new d.Declaration(g);return this._nextIs("keyword","ITZ")?(this._consume(),this._nextIs("keyword","A")?(this._consume(),a=j[this.parseType()],a=new d.Assignment(g,a)):a=new d.Assignment(g,this.parseExpression()),new d.StatementList([c,a])):c};i.prototype.parseAssignment=function(){var a;a=this._consume("identifier");this._consume("keyword","R");return new d.Assignment(a,this.parseExpression())};i.prototype.parseIndexedAssignment=function(){var a,c,g;this._consume("keyword",
"PUTZ");g=this.parseExpression();this._consume("keyword","INTA");a=this._consume("identifier");this._consume("keyword","AT");c=this.parseExpression();return new d.IndexedAssignment(a,c,g)};i.prototype.parseLoopStatement=function(){var a,c,g,i,m,j,p;this._consume("keyword","IM IN YR");g=this._consume("identifier");m=j=null;this._nextIs("endline")||(!this._nextIs("keyword","UPPIN")&&!this._nextIs("keyword","NERFIN")&&!this._nextIs("identifier")&&this._error("A loop operation must follow the loop label"),
m=this._consume(),this._consume("keyword","YR"),j=this._consume("identifier"),p=new d.IdentifierExpression(j),a=function(){switch(m){case "UPPIN":return new d.BinaryExpression("SUM OF",p,new d.IntLiteral(1));case "NERFIN":return new d.BinaryExpression("DIFF OF",p,new d.IntLiteral(1));default:return this.function_arities[m]!==1&&this._error("Loop operation must be UPPIN, NERFIN or a unary function"),new d.CallExpression(m,[p])}}.call(this),m=new d.Assignment(j,a),this._nextIs("endline")||(this._nextIs("keyword",
"WILE")?c=false:this._nextIs("keyword","TIL")?c=true:this._error("A loop variable must be followed by WILE or TIL"),this._consume(),i=this.parseExpression(),c&&(i=new d.UnaryExpression("NOT",i))));this._consume("endline");this._scope_depth++;a=function(){var a;for(a=[];!this._nextIs("keyword","IM OUTTA YR");)a.push(this.parseStatement());return a}.call(this);a=new d.StatementList(a);this._scope_depth--;this._consume("keyword","IM OUTTA YR");g!==this._consume("identifier")&&this._error("Mismatched loop label");
return new d.Loop(m,i,a)};i.prototype.parseConditionalStatement=function(){var a,c,g,i,m,j,p,v=this;this._consume("keyword","O RLY?");this._consume("endline");this._consume("keyword","YA RLY");this._consume("endline");m=function(){return v._nextIs("keyword","MEBBE")||v._nextIs("keyword","NO WAI")||v._nextIs("keyword","OIC")};i=function(){var a;for(a=[];!m();)a.push(this.parseStatement());return a}.call(this);j=new d.StatementList(i);for(i=[];this._nextIs("keyword","MEBBE");)this._consume(),c=this.parseExpression(),
this._consume("endline"),a=function(){var a;for(a=[];!m();)a.push(this.parseStatement());return a}.call(this),i.push([c,new d.StatementList(a)]);c=[];a=null;this._nextIs("keyword","OIC")||(this._consume("keyword","NO WAI"),this._consume("endline"),(c=function(){var a;for(a=[];!this._nextIs("keyword","OIC");)a.push(this.parseStatement());return a}.call(this))&&(a=new d.StatementList(c)));for(this._consume("keyword","OIC");i.length;)p=i.pop(),c=p[0],g=p[1],c=new d.Assignment("IT",c),a=new d.Conditional(g,
a),a=new d.StatementList([c,a]);return new d.Conditional(j,a)};i.prototype.parseSwitchStatement=function(){var a,c,g,i;this._consume("keyword","WTF?");this._consume("endline");c=[];g=null;for(this._scope_depth++;!this._nextIs("keyword","OIC");)this._nextIs("keyword","OMG")?(this._consume(),a=this.tokens[0].line,i=this.parseLiteral(),i instanceof d.Literal||this._error("OMG value must be a literal",a),this._consume("endline"),a=function(){var a;for(a=[];!this._nextIs("keyword","OMG")&&!this._nextIs("keyword",
"OMGWTF")&&!this._nextIs("keyword","OIC");)a.push(this.parseStatement());return a}.call(this),c.push([i,new d.StatementList(a)])):this._nextIs("keyword","OMGWTF")?(this._consume(),this._consume("endline"),a=function(){var a;for(a=[];!this._nextIs("keyword","OIC");)a.push(this.parseStatement());return a}.call(this),g=new d.StatementList(a)):this._error("Expected OMG, OMGWTF or OIC");this._consume();this._scope_depth--;return new d.Switch(c,g)};i.prototype.parseExpression=function(){var a;return this._nextIs("keyword")?
(a=this.tokens[0].text,a==="MAEK"?this.parseCastExpression():r.call(o,a)>=0?this.parseUnaryExpression():r.call(w,a)>=0?this.parseBinaryExpression():r.call(x,a)>=0?this.parseInfinitaryExpression():a==="WIN"||a==="FAIL"||a==="NOOB"?this.parseLiteral():this._error("Invalid keyword at start of expression")):this._nextIs("identifier")?(a=this.tokens[0].text in this.function_arities?this.parseFunctionCall():new d.IdentifierExpression(this._consume()),this._nextIs("keyword","AT")?(this._consume(),new d.IndexingExpression(a,
this.parseExpression())):a):this.parseLiteral()};i.prototype.parseCastExpression=function(){var a;this._consume("keyword","MAEK");a=this.parseExpression();this._nextIs("keyword","A")&&this._consume();return new d.CastExpression(a,this.parseType())};i.prototype.parseCastStatement=function(){var a,c;c=this._consume("identifier");a=new d.IdentifierExpression(c);this._consume("keyword","IS NOW A");a=new d.CastExpression(a,this.parseType());return new d.Assignment(c,a)};i.prototype.parseType=function(){var a;
a=this._consume("keyword");a in j||this._error("Unknown type");return a};i.prototype.parseLiteral=function(){var a;return this._nextIs("string")?this._createStringLiteral(this._consume()):this._nextIs("int")?new d.IntLiteral(parseInt(this._consume(),10)):this._nextIs("float")?new d.FloatLiteral(parseFloat(this._consume())):this._nextIs("keyword")?(a=this._consume(),a==="WIN"||a==="FAIL"?new d.BoolLiteral(a==="WIN"):a==="NOOB"?new d.NullLiteral:this._error("Unexpected keyword while parsing literal",
a.line)):this._error("Could not parse literal")};i.prototype.parseFunctionCall=function(){var a;a=this._consume("identifier");a in this.function_arities||this._error("Undefined function: "+a);var c,g,i;i=[];for(c=0,g=this.function_arities[a];0<=g?c<g:c>g;0<=g?++c:--c)i.push(this.parseExpression());return new d.CallExpression(a,i)};i.prototype.parseOutputStatement=function(){this._consume("keyword","VISIBLE");var a;for(a=[];!this._nextIs("keyword","!")&&!this._nextIs("endline");)a.push(this.parseExpression());
this._nextIs("keyword","!")?this._consume():a.push(new d.StringLiteral("\n"));return new d.Output(new d.InfinitaryExpression("SMOOSH",a))};i.prototype.parseUnaryExpression=function(){var a;a=this._consume("keyword");r.call(o,a)<0&&this._error("Unknown unary operator: "+a);return new d.UnaryExpression(a,this.parseExpression())};i.prototype.parseBinaryExpression=function(){var a,c,g;c=this._consume("keyword");r.call(w,c)<0&&this._error("Unknown binary operator: "+c);a=this.parseExpression();this._nextIs("keyword",
"AN")&&this._consume();g=this.parseExpression();return new d.BinaryExpression(c,a,g)};i.prototype.parseInfinitaryExpression=function(){var a;a=this._consume("keyword");r.call(x,a)<0&&this._error("Unknown infinitary operator: "+a);var c;for(c=[];!this._nextIs("keyword","MKAY")&&!this._nextIs("endline");)this._nextIs("keyword","AN")&&this._consume(),c.push(this.parseExpression());this._nextIs("keyword","MKAY")&&this._consume();return new d.InfinitaryExpression(a,c)};i.prototype._createStringLiteral=
function(a){var c,g,i,j,o,p;/^".*"$/.test(a)||this._error("Invalid string literal: "+a);a=a.slice(1,-1);j=[];c=[];for(i=o=0,p=a.length;o<p;i=++o)if(g=a[i],g===":")switch(g=a[++i],g){case ")":c.push("\n");break;case ">":c.push("\t");break;case "o":c.push("g");break;case '"':c.push('"');break;case ":":c.push(":");break;case "(":g=a.slice(i).match(/\(([\da-fA-F]+)\)/);c.push(String.fromCharCode(parseInt(g[1],16)));break;case "{":g=a.slice(i).match(/\{([a-zA-Z]\w*)\}/);c.length&&j.push(new d.StringLiteral(c.join("")));
j.push(new d.IdentifierExpression(g[1]));c=[];break;case "[":this._error("Unicode name embedding not implemented yet: "+a)}else c.push(g);return j.length?(c.length&&j.push(new d.StringLiteral(c.join(""))),new d.InfinitaryExpression("SMOOSH",j)):new d.StringLiteral(c.join(""))};i.prototype._consume=function(a,c){var d,i;if(!(a!=null||c!=null))return this.tokens.shift().text;if(this._nextIs(a,c))return this._consume();else throw this.tokens.length===0?(i="(last)",d="(end of input)"):(i=this.tokens[0].line,
d=""+this.tokens[0].type+"("+this.tokens[0].text+")"),new u(i,"Expected: "+(c!=null?""+a+"('"+(c||"")+"')":a)+"; Got: "+d);};i.prototype._nextIs=function(a,c){return this.tokens.length&&this.tokens[0].is(a,c)};i.prototype._error=function(a,c){c?a+=", near "+this.tokens[0].type+":'"+this.tokens[0].text+"'":c=this.tokens.length?this.tokens[0].line:c="(last)";throw new u(c,a);};return i}();this.LOLCoffee.ParserError=u}).call(this);
(function(){var d,w,j,x,u,o,s,t,r,i,a,c,g,y,m={}.hasOwnProperty,G=function(a,c){function d(){this.constructor=a}for(var i in c)m.call(c,i)&&(a[i]=c[i]);d.prototype=c.prototype;a.prototype=new d;a.__super__=c.prototype;return a},p=[].indexOf||function(a){for(var c=0,d=this.length;c<d;c++)if(c in this&&this[c]===a)return c;return-1};o=this.LOLCoffee.KEYWORDS;u=/^-?\d+/;w=/^-?(\d+\.\d*|\.\d+)/;j=/^[a-zA-Z]\w*/;r=/^OBTW\b[^]*?\bTLDR\b/;d=/^BTW\b.*/;t=/^(\u2026|\.\.\.)[ \t\v]*(\r\n|\r|\n)/;i=/^(\r\n|\r|\n|,)/;
x=/^[ \t\v]+/;a=/^"(?::(?:[)>o":]|\([\dA-Fa-f]+\)|\{[A-Za-z]\w*\}|\[[^\[\]]+\])|[^":])*"/;o=function(){var a,c,d;d=[];for(a=0,c=o.length;a<c;a++)y=o[a],d.push(y.replace(/\?/g,"\\?").replace(/\s/g,"[ \\t\\v]+"));return d}();s=RegExp("^("+o.join("|")+")(?=$|\\b|\\W)");g=function(a){function c(a,d){this.message="Line "+a+": "+d+"."}G(c,a);c.name="TokenizerError";c.prototype.name="TokenizerError";return c}(Error);c=function(){function a(c,d,i){this.line=c;this.type=d;this.text=i!=null?i:"";if(p.call(a.prototype.TYPES,
d)<0)throw new g(c,"Invalid token type: "+d);}a.name="Token";a.prototype.is=function(a,c){return this.type===a&&(c===void 0||this.text===c)};a.prototype.TYPES="endline,keyword,identifier,int,float,string".split(",");return a}();this.LOLCoffee.Tokenizer=function(){function m(a){this.text=a;this.tokens=[];this.line=[];this.line_index=1}m.name="Tokenizer";m.prototype.tokenize=function(){for(var c,g;this.text;){if(!(g=this.text.match(x)))if(g=this.text.match(t))i.test(this.text.slice(g[0].length))&&this._error("Cannot have an empty line after line continuation");
else if(g=this.text.match(i))this._flushLine();else if(!(g=this.text.match(d)))(g=this.text.match(r))?this.line.length&&this._error("Multiline comments must start on a new line"):(g=this.text.match(s))?this._emit("keyword",g[0].replace(/\s+/g," ")):(g=this.text.match(j))?this._emit("identifier",g[0]):(g=this.text.match(w))?this._emit("float",g[0]):(g=this.text.match(u))?this._emit("int",g[0]):(g=this.text.match(a))?this._emit("string",g[0]):(c=this.text.match(/^.*/)[0],this._error("Unrecognized sequence at: "+
c));(c=g[0].match(/\r\n|\r|\n/g))&&(this.line_index+=c.length);this.text=this.text.slice(g[0].length)}this._flushLine();return this.tokens};m.prototype._flushLine=function(){if(this.line.length)this.tokens=this.tokens.concat(this.line),this.tokens.push(new c(this.line_index,"endline"));return this.line=[]};m.prototype._emit=function(a,d){return this.line.push(new c(this.line_index,a,d))};m.prototype._error=function(a){throw new g(this.line_index,a);};return m}();this.LOLCoffee.TokenizerError=g}).call(this);
