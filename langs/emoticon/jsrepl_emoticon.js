(function(){self.JSREPLEngine=function(){function c(a,b,d,f,c,i){this.input=a;this.output=b;this.error=f;this.sandbox=c;this.result_fn_factory=function(a){return function(b){var e,c,d,f;f="";for(c in b)e=b[c],d=e.toString(),e=d.length-74,e=e>0?e:0,d=d.slice(e),e>0&&(d="..."+d),f+="\n"+c+": "+d;return a(f)}};this.result_handler=this.result_fn_factory(d);this.interpreter=new this.sandbox.Emoticon.Interpreter({source:[],input:this.input,print:this.output,result:this.result_handler});i()}c.name="JSREPLEngine";
c.prototype.Eval=function(a){var b;try{if(a.match(/^RESET\b/))this.interpreter=new this.sandbox.Emoticon.Interpreter({source:[],input:this.input,print:this.output,result:this.result_handler}),a=a.replace(/^RESET/,"");b=new this.sandbox.Emoticon.Parser(a);this.interpreter.lists.Z=this.interpreter.lists.Z.concat(b);return this.interpreter.run()}catch(d){return this.error(d)}};c.prototype.EvalSync=function(a){var b;this.interpreter.lists.Z=this.interpreter.lists.Z.concat(new this.sandbox.Emoticon.Parser(a));
b=null;this.interpreter.result=this.result_fn_factory(function(a){return b=a});this.interpreter.run();this.interpreter.result=this.result_handler;return b};c.prototype.GetNextLineIndent=function(a){var b,d=this;b=function(a){var b,c,g,h;c=new d.sandbox.Emoticon.Parser(a);a=0;for(g=0,h=c.length;g<h;g++)if(b=c[g],b.mouth)switch(b.mouth){case "(":++a;break;case ")":--a}return a};return b(a)<=0?false:(a=b(a.split("\n").slice(-1)[0]),a>0?1:a<0?a:0)};return c}()}).call(this);
