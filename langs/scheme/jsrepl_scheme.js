(function(){self.JSREPLEngine=function(){function d(a,b,c,g,f,e){this.result=c;this.sandbox=f;c=this.sandbox.BiwaScheme.Port;c.current_input=new c.CustomInput(a);c.current_output=new c.CustomOutput(b);c.current_error=c.current_output;this.interpreter=new this.sandbox.BiwaScheme.Interpreter(g);e()}d.name="JSREPLEngine";d.prototype.Eval=function(a){var b=this;try{return this.interpreter.evaluate(a,function(a){var c;if(a!==void 0)return c="",a!=null&&a!==b.sandbox.BiwaScheme.undef&&(c=b.sandbox.BiwaScheme.to_write(a)),
b.result(c)})}catch(c){return this.interpreter.on_error(c.message)}};d.prototype.EvalSync=function(a){var b;b=null;this.interpreter.evaluate(a,function(a){return b=a});return b};d.prototype.IsCommandComplete=function(a){var b,c,g,f,e;g=(new this.sandbox.BiwaScheme.Parser(a)).tokens;a=b=0;for(f=0,e=g.length;f<e;f++)switch(c=g[f],c){case "[":++a;break;case "]":--a;break;case "(":++b;break;case ")":--b}return b<=0&&a<=0};d.prototype.GetNextLineIndent=function(a){var b,c=this;b=function(a){var b,e,d,
h;e=(new c.sandbox.BiwaScheme.Parser(a)).tokens;a=0;for(d=0,h=e.length;d<h;d++)switch(b=e[d],b){case "[":case "(":++a;break;case "]":case ")":--a}return a};return b(a)<=0?false:(a=b(a.split("\n").slice(-1)[0]),a>0?1:a<0?a:0)};return d}()}).call(this);
